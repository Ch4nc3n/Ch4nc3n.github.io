## Pulse Policy Secure 授权后任意文件读取漏洞

## 漏洞描述

Pulse Policy Secure 9.1R12.0 存在路径穿越漏洞，经过授权的用户可以读取任意文件。<br>
Pulse Policy Secure 9.1R12.0 下载地址:<br>
https://application.ivanti.com/SSG/IPS/ps-pps-vmware-psa-v-9.1r12.0-b6427-package.zip<br>

## 漏洞细节

漏洞存在于以下文件中:<br>
/home/webserver/htdocs/dana-admin/radclient/radiusdict.cgi <br>
/home/webserver/htdocs/dana-admin/snmp/snmptemplates.cgi <br>
/home/webserver/htdocs/dana-admin/integrations/inttemplates.cgi<br>

```
sub restoreDefaultDictionary {
    my $id = DSCGI::str_param('id');
    my $version = DSCGI::int_param('txtVersion');
    my $filename = DSCGI::str_param('txtFilename');

    my ($rc, $name) = EPConfig::RadiusAdmin::getDictionaryName($id);
    my $status = new DSUtil::DSStatus();
    my $path = ($ENV{'DSINSTALL'} =~ /(\S*)/)[0] . "/radius/" . $filename;
    $rc = EPConfig::RadiusAdmin::updateDictionaryFile($id, $version, $filename, $path, $status);
    if ($rc) {
        AdminUI::addPageErrorMsg($g_uivars, AdminUI::getBox("info",
                    "'" . DSCGI::escape_html($name) . "' dictionary file " .
                    "'" . DSCGI::escape_html($filename) . "' successfully restored."));
    }

    if (defined($status)) {
        my $count = $status->getCount();
        for (my $ii=0; $ii<$count; $ii++) {
            AdminUI::addPageErrorMsg($g_uivars,
                                     AdminUI::getErrorMsg(DSCGI::escape_html($status->getMessage($ii))));
        }
    }

    return $rc;
}
```

"txtFilename"参数没有做有效验证，可以通过路径穿越进行任意文件读取。

## 漏洞利用

任意文件读取